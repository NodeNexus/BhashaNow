<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BhashaNow</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(-45deg, #ff9a9e, #fad0c4, #84fab0, #8fd3f4);
            background-size: 400% 400%;
            animation: gradientBG 20s ease infinite;
        }
        #particle-canvas { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; }
        @keyframes gradientBG { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }
        
        .glass-bg {
            background: rgba(255, 255, 255, 0.25);
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.18);
        }
        .logo-gradient {
            background: -webkit-linear-gradient(45deg, #f97316, #ea580c);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        .sidebar-link {
            transition: background 0.2s, color 0.2s, padding-left 0.2s;
        }
        .sidebar-link:hover, .sidebar-link.active {
            background-color: rgba(255,255,255,0.2);
            padding-left: 1.25rem;
        }
    </style>
</head>
<body class="min-h-screen">
    <canvas id="particle-canvas"></canvas>
    
    <div class="flex h-screen bg-transparent">
        <!-- Sidebar -->
        <aside class="w-64 flex-shrink-0 p-4 hidden md:flex flex-col">
            <div class="flex-grow glass-bg rounded-2xl flex flex-col p-4">
                <a href="/hub" class="flex items-center space-x-2 px-2 pb-4 border-b border-white/20">
                    <span class="text-3xl font-bold logo-gradient">अ</span>
                    <span class="text-xl font-bold text-gray-800">BhashaNow</span>
                </a>
                <nav class="mt-8 space-y-2">
                    <a href="/hub" class="sidebar-link active flex items-center gap-3 py-2 px-4 rounded-lg text-gray-800 font-semibold">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"></path></svg>
                        Dashboard
                    </a>
                    <a href="/userprofile" class="sidebar-link flex items-center gap-3 py-2 px-4 rounded-lg text-gray-800 font-semibold">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path></svg>
                        Profile
                    </a>
                </nav>
                <div class="mt-auto">
                    <a href="/" class="sidebar-link flex items-center gap-3 py-2 px-4 rounded-lg text-gray-800 font-semibold">
                         <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"></path></svg>
                        Log Out
                    </a>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="flex-1 p-4 flex flex-col">
            <div class="flex-grow glass-bg rounded-2xl p-6 md:p-8 flex flex-col">
                <!-- Header -->
                <header class="flex-shrink-0">
                    <div class="flex justify-between items-center">
                        <div>
                            <h1 class="text-3xl font-bold text-gray-800">Text Transliteration</h1>
                            <p class="text-gray-700 mt-1">Type or paste text and see it in a new script.</p>
                        </div>
                        <a href="/userprofile" title="View Profile" class="md:hidden">
                            <img class="w-12 h-12 rounded-full border-2 border-orange-500 object-cover" src="https://placehold.co/100x100/f97316/FFFFFF?text=A" alt="User Avatar">
                        </a>
                    </div>
                </header>

                <!-- Transliteration Tool -->
                <section id="transliteration-tool" class="mt-8 flex-grow flex flex-col">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 flex-grow">
                        <!-- Input Column -->
                        <div class="flex flex-col">
                            <label for="input-text" class="text-lg font-semibold text-gray-800 mb-2">Enter Text</label>
                            <textarea id="input-text" placeholder="Enter text here..." class="flex-grow p-4 rounded-lg bg-white/50 border border-white/30 resize-none focus:outline-none focus:ring-2 focus:ring-orange-500"></textarea>
                        </div>
                        <!-- Output Column -->
                        <div class="flex flex-col">
                           <label for="output-text" class="text-lg font-semibold text-gray-800 mb-2">Transliterated Text</label>
                            <div id="output-text" class="flex-grow p-4 rounded-lg bg-white/30 border border-white/20">
                                <span class="text-gray-500">Your result will appear here...</span>
                            </div>
                        </div>
                    </div>
                    <form id="translation-form" class="space-y-4">
                        <div class="flex gap-4">
                            <div class="flex-1">
                                <label for="lang-from" class="block text-sm font-medium text-gray-700 mb-2">Language From</label>
                                <select id="lang-from" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent">
                                    <option value="english" selected>English</option>
                                    <option value="hindi">Hindi</option>
                                    <option value="marathi">Marathi</option>
                                    <option value="nepali">Nepali</option>
                                    <option value="urdu">Urdu</option>
                                    <option value="telugu">Telugu</option>
                                    <option value="kannada">Kannada</option>
                                    <option value="bengali">Bengali</option>
                                    <option value="assamese">Assamese</option>
                                </select>
                            </div>
                            <div class="flex-1">
                                <label for="lang-to" class="block text-sm font-medium text-gray-700 mb-2">Language To</label>
                                <select id="lang-to" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent">
                                    <option value="english">English</option>
                                    <option value="hindi" selected>Hindi</option>
                                    <option value="marathi">Marathi</option>
                                    <option value="nepali">Nepali</option>
                                    <option value="urdu">Urdu</option>
                                    <option value="telugu">Telugu</option>
                                    <option value="kannada">Kannada</option>
                                    <option value="bengali">Bengali</option>
                                    <option value="assamese">Assamese</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="flex-shrink-0 mt-6 flex flex-col md:flex-row items-center gap-4">
                            <button type="submit" id="transliterate-btn" class="w-full md:w-auto bg-orange-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-orange-700 transition-colors">
                                Transliterate
                            </button>
                        </div>
                    </form>
                </section>
            </div>
        </main>
    </div>

    <script>
        const translationForm = document.getElementById('translation-form');
        const outputText = document.getElementById('output-text');
        const transliterateBtn = document.getElementById('transliterate-btn');
        
        translationForm.addEventListener('submit', async (e) => {
            e.preventDefault();

            const langFrom = document.getElementById('lang-from').value;
            const langTo = document.getElementById('lang-to').value;
            const textInput = document.getElementById('input-text')?.value?.trim();

            if (!textInput) {
                alert('Please enter some text');
                return;
            }

            // Show loading state
            transliterateBtn.disabled = true;
            transliterateBtn.textContent = 'Transliterating...';
            outputText.innerHTML = '<span class="text-gray-500">Processing...</span>';

            try {
                const response = await fetch('/api/transliterate', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        text: textInput,
                        langFrom: langFrom,
                        langTo: langTo
                    })
                });

                if (!response.ok) throw new Error('Failed to transliterate');

                const data = await response.json();

                // Display results
                outputText.innerHTML = `<span class="text-gray-800">${data.result || 'Transliteration failed'}</span>`;

            } catch (error) {
                console.error('Error:', error);
                outputText.innerHTML = `<span class="text-red-600">Error: ${error.message}</span>`;
            } finally {
                // Reset button state
                transliterateBtn.disabled = false;
                transliterateBtn.textContent = 'Transliterate';
            }
        });

        const canvas = document.getElementById('particle-canvas');
        if (canvas) {
            const ctx = canvas.getContext('2d');
            let particles = [];
            let mouse = { x: null, y: null, radius: 150 };
            const indianAlphabets = 'أ ب ت ث ج ح خ د ذ ر ز س ش ص ض ط ظ ع غ ف ق ك ل م ن ه و ي a b c d e f g h i j k l m n o p q r s t u v w x y z';

            const setCanvasSize = () => {
                canvas.width = window.innerWidth;
                canvas.height = window.innerHeight;
            };

            const createParticles = () => {
                particles = [];
                const particleCount = Math.floor((canvas.width * canvas.height) / 10000);
                for (let i = 0; i < particleCount; i++) {
                    const size = Math.random() * 22 + 10;
                    particles.push({
                        x: Math.random() * canvas.width,
                        y: Math.random() * canvas.height,
                        char: indianAlphabets[Math.floor(Math.random() * indianAlphabets.length)],
                        size: size,
                        baseVx: (Math.random() - 0.5) * 0.2,
                        baseVy: (Math.random() - 0.5) * 0.2,
                        vx: (Math.random() - 0.5) * 0.2,
                        vy: (Math.random() - 0.5) * 0.2,
                        color: `rgba(255, 255, 255, ${Math.random() * 0.4 + 0.2})`
                    });
                }
            };
            
            const animate = () => {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                particles.forEach(p => {
                    if (mouse.x && mouse.y) {
                        const dx = p.x - mouse.x;
                        const dy = p.y - mouse.y;
                        const distance = Math.sqrt(dx * dx + dy * dy);
                        if (distance < mouse.radius) {
                            const force = (mouse.radius - distance) / mouse.radius;
                            p.vx += (dx / distance) * force * 0.15;
                            p.vy += (dy / distance) * force * 0.15;
                        }
                    }
                    p.vx *= 0.95;
                    p.vy *= 0.95;
                    p.vx += p.baseVx * 0.05;
                    p.vy += p.baseVy * 0.05;
                    p.x += p.vx;
                    p.y += p.vy;
                    if (p.x < -p.size) p.x = canvas.width + p.size;
                    if (p.x > canvas.width + p.size) p.x = -p.size;
                    if (p.y < -p.size) p.y = canvas.height + p.size;
                    if (p.y > canvas.height + p.size) p.y = -p.size;
                    
                    ctx.fillStyle = p.color;
                    ctx.font = `${p.size}px Inter`;
                    ctx.fillText(p.char, p.x, p.y);
                });
                
                requestAnimationFrame(animate);
            };
            
            window.addEventListener('mousemove', (e) => { mouse.x = e.clientX; mouse.y = e.clientY; });
            window.addEventListener('mouseout', () => { mouse.x = null; mouse.y = null; });
            window.addEventListener('resize', () => { setCanvasSize(); createParticles(); });

            setCanvasSize();
            createParticles();
            animate();
        }
    </script>

</body>
</html>

